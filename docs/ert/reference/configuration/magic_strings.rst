Magic strings
=============

ERT exposes some magic strings that can be used in your configuration file.
These strings will at runtime be replaced with corresponding values, and
can be useful if you need to use information such as file paths or experiment
information such as realization or iteration number in your workflows or forward
model steps.

Example:
::

   YOUR_WORKFLOW_JOB <RUNPATH_FILE> <CONFIG_PATH>

Will be replaced with something similar to the following at runtime

::

   YOUR_WORKFLOW_JOB /path/to/the/runpath/file/.ert_runpath_list /path/to/config/

In the following we separate between :ref:`experiment constants <ms_exp_constants>`,
:ref:`experiment variables <ms_exp_variables>` and :ref:`experiment dependent variables <ms_exp_dependent_variables>`.
Experiment constants are magic strings that do not change based on the iteration or realization number,
while experiment variables will typically be replaced with different values depending on
the current iteration or realization index. The dependent variables might also change
(depending on whether variables are used in the definition), but the changes directly
depend on the changes in the experiment variables.


**It should also be noted that experiment variables can only be used with
forward model steps and not with workflows.**


List of keywords
----------------


* Experiment constants

   * :ref:`RUNPATH_FILE <ms_runpath_file>`
   * :ref:`CONFIG_PATH <ms_config_path>`
   * :ref:`CONFIG_FILE <ms_config_file>`
   * :ref:`CONFIG_FILE_BASE <ms_config_file_base>`
   * :ref:`CWD <ms_cwd>`
   * :ref:`DATE <ms_date>`

* Experiment variables

   * :ref:`IENS <ms_iens>`
   * :ref:`ITER <ms_iter>`

* Experiment dependent variables

   * :ref:`ECLBASE/ECL_BASE <ms_eclbase>`
   * :ref:`RUNPATH <ms_runpath>`
   * :ref:`ERTCASE <ms_ertcase>`



.. _ms_exp_constants:

Experiment constants
--------------------

.. _ms_runpath_file:
.. topic:: RUNPATH_FILE

    Will be replaced with an absolute path to the :ref:`RUNPATH_FILE <runpath_file>`.

   **Example:**

   ::

      YOUR_WORKFLOW_JOB <RUNPATH_FILE>

   Will be replaced with the following at runtime:

   ::

      YOUR_WORKFLOW_JOB /path/to/the/runpath/file/.ert_runpath_list

.. _ms_config_path:
.. topic:: CONFIG_PATH

   Will be replaced with the path to the directory containing the config file for the experiment.


   *Example:*

   ::

      YOUR_WORKFLOW_JOB <CONFIG_PATH>

   Will be replaced with the following at runtime:

   ::

      YOUR_WORKFLOW_JOB /path/to/config/

.. _ms_config_file:
.. topic:: CONFIG_FILE

   Will be replaced with the name of the config file for the experiment.


   *Example:*

   ::

      YOUR_WORKFLOW_JOB <CONFIG_FILE>

   Will be replaced with the following at runtime:

   ::

      YOUR_WORKFLOW_JOB example.ert

.. _ms_config_file_base:
.. topic:: CONFIG_FILE_BASE

   Will be replaced with the base name of the config file for the experiment.
   This is the filename without the extension.


   *Example:*

   ::

      YOUR_WORKFLOW_JOB <CONFIG_FILE_BASE>

   Given that the filename is `example.ert`, this will be replaced with the following at runtime:

   ::

      YOUR_WORKFLOW_JOB example

.. _ms_cwd:
.. topic:: CWD

   Will be replaced with the current working directory.
   This will usually be the same as the :ref:`CONFIG_PATH <ms_config_path>`.


   *Example:*

   ::

      YOUR_WORKFLOW_JOB <CWD>

   Will be replaced with the following at runtime:

   ::

      YOUR_WORKFLOW_JOB /data/repos/ert/test-data/ert/poly_example

.. _ms_date:
.. topic:: DATE

    Will be replaced with the current date in ISO-8601 format (YYYY-MM-DD).

.. _ms_exp_variables:

Experiment variables
--------------------

.. warning::
   The experiment variables cannot be used with workflows, only in forward
   model steps.

.. _ms_iens:
.. topic:: IENS

   Will be replaced with the index for the current realization.
   The realization number uses zero-based indexing.


   *Example:*

   ::

      FORWARD_MODEL STEP_NAME(<ARG0>=<IENS>)

   Will in the third realization be replaced with the following at runtime:

   ::

      FORWARD_MODEL STEP_NAME(<ARG0>=2)

.. _ms_iter:
.. topic:: ITER

   Will be replaced with the current iteration number.
   The iteration number uses zero-based indexing.


   *Example:*

   ::

      FORWARD_MODEL STEP_NAME(<ARG0>=<ITER>)

   In the second iteration of your experiment, this will be replaced with the following at runtime:

   ::

      FORWARD_MODEL STEP_NAME(<ARG0>=1)

.. _ms_exp_dependent_variables:

Experiment dependent variables
------------------------------

.. _ms_eclbase:
.. topic:: ECLBASE / ECL_BASE

   Will be replaced by the basename for the ECLIPSE simulations generated by ERT.
   See :ref:`ECLBASE <eclbase>` for more details.
   For non-Eclipse jobs this will be replaced by the job name (with an iteration identifier)


   *Example:*

   ::

      FORWARD_MODEL STEP_NAME(<ARG0>=<ECLBASE>)

   Given that the ECLBASE has been specified using `ECLBASE eclipse/model/OIL_FIELD-<IENS>`
   in the config file, this will be replaced with the following in the second iteration:

   ::

      FORWARD_MODEL STEP_NAME(<ARG0>="eclipse/model/OIL_FIELD-2")


.. _ms_runpath:
.. topic:: RUNPATH

   Will be replaced with the runpath for current iteration number and realization index.


   *Example:*

   ::

      FORWARD_MODEL STEP_NAME(<ARG0>=<RUNPATH>)

   In the second iteration for the fifth realization, this will be replaced
   with the following at runtime:

   ::

      FORWARD_MODEL STEP_NAME(<ARG0>="/your/run/path/realization-4/iter-1")


.. _ms_ertcase:
.. topic:: ERTCASE

   Will be replaced with the current case name defined when starting the experiment.


   *Example:*

   ::

      RUNPATH output/<ERTCASE>/realization-<IENS>/iter-<ITER>

   In this example when running the experiment and given that the user does not
   change the `default` case name the output folder created for realization 10
   iteration 4 will be the following:

   ::

      output/default/realization-10/iter-4
